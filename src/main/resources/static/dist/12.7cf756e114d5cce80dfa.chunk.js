webpackJsonp([12],{616:function(e,t,r){"use strict";function n(e){d||r(830)}Object.defineProperty(t,"__esModule",{value:!0});var s=r(639),i=r.n(s);for(var o in s)"default"!==o&&function(e){r.d(t,e,function(){return s[e]})}(o);var a=r(832),l=r.n(a),d=!1,u=r(24),c=n,p=u(i.a,l.a,!1,c,null,null);p.options.__file="src/views/admin/user/main.vue",t.default=p.exports},639:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(233),s=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(103),o=function(e,t,r){return t("Poptip",{props:{confirm:"",title:"您确定要删除这个用户信息吗？"},style:{marginRight:"5px"},on:{"on-ok":function(){e.del(r.row.id)}}},[t("Button",{props:{type:"error",size:"small"}},"删除")])},a=function(e,t,r){return t("Poptip",{props:{confirm:"",title:"您确定要重置这个用户密码吗？"},style:{marginRight:"5px"},on:{"on-ok":function(){e.resetPwd(r.row.id)}}},[t("Button",{props:{type:"error",size:"small"}},"重置密码")])},l=function(e,t,r){return t("Poptip",{props:{confirm:"",title:"您确定要禁用这个用户吗？"},style:{marginRight:"5px"},on:{"on-ok":function(){e.stop(r.row.id)}}},[t("Button",{props:{type:"error",size:"small"}},"禁用")])},d=function(e,t,r){return t("Poptip",{props:{confirm:"",title:"您确定要激活这个用户吗？"},style:{marginRight:"5px"},on:{"on-ok":function(){e.active(r.row.id)}}},[t("Button",{props:{type:"success",size:"small"}},"激活")])},u=function(e,t,r){return t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(r.row)}}},"编辑")};t.default={computed:(0,s.default)({},(0,i.mapState)({userList:function(e){return e.user.userList},totalPage:function(e){return e.user.totalPage},pageNumber:function(e){return e.user.pageNumber},pageSize:function(e){return e.user.pageSize},total:function(e){return e.user.totalRow},roleList:function(e){return e.role.roleList},user:function(e){return e.user.user}})),methods:{del:function(e){var t=this;this.$store.dispatch("user_del",{id:e}).then(function(e){setTimeout(t.search,1e3)})},edit:function(e){this.modalTitle="修改用户",this.isAdd=!1;var t=this;this.$store.dispatch("role_list").then(function(r){t.$store.commit("user_reset",e),t.userModal=!0})},stop:function(e){var t=this;this.$store.dispatch("user_stop",{ids:e}).then(function(e){setTimeout(t.search,1e3)})},active:function(e){var t=this;this.$store.dispatch("user_active",{ids:e}).then(function(e){setTimeout(t.search,1e3)})},add:function(){this.isAdd=!0,this.modalTitle="新增用户";var e=this;this.$store.dispatch("role_list").then(function(t){e.userModal=!0,e.$store.commit("user_reset")})},save:function(){var e=this,t=this;this.modalLoading=!0,this.$refs.formValidate.validate(function(r){if(r){var n="save";t.isAdd||(n="update"),e.$store.dispatch("user_save",n).then(function(r){r&&"success"==r?(t.userModal=!1,e.$store.dispatch("user_list")):e.modalLoading=!1})}else e.modalLoading=!1})},search:function(e){this.$store.dispatch("user_list",{search:this.searchKey,pn:e})},refresh:function(){this.$store.dispatch("user_list",{search:this.searchKey})},setRole:function(e){},vChange:function(e){e||(this.$refs.formValidate.resetFields(),this.modalLoading=!1)},reset:function(){this.$refs.formValidate.resetFields()},resetPwd:function(e){var t=this;this.$store.dispatch("user_reset_pwd",{id:e}).then(function(e){e.resCode&&"success"==e.resCode?t.$Modal.success({title:"提示消息",content:e.resMsg}):e.resCode&&"fail"==e.resCode?t.$Modal.error({title:"提示消息",content:e.resMsg}):t.$Modal.error({title:"提示消息",content:"密码重置失败"})})}},mounted:function(){this.$store.dispatch("user_list")},data:function(){var e=this;return{self:this,searchKey:"",userModal:!1,isAdd:!0,modalTitle:"新增用户",modalLoading:!1,ruleValidate:{loginname:[{type:"string",required:!0,message:"用户名不能为空",trigger:"blur"},{type:"string",max:50,message:"用户名长度不能超过50",trigger:"blur"}],nickname:[{required:!0,message:"姓名不能为空",max:50,trigger:"blur"},{type:"string",message:"姓名长度不能超过50",max:50,trigger:"blur"}],phone:[{required:!0,message:"手机号不能为空",max:20,trigger:"blur"},{type:"string",message:"请输入11位手机号",len:11,trigger:"blur"},{type:"string",message:"手机号码无效",pattern:/^((13|14|15|17|18)[0-9]{1}\d{8})$/,trigger:"blur"}],email:[{type:"email",message:"email格式不正确",max:255,trigger:"blur"},{type:"string",message:"email长度不能超过255",max:255,trigger:"blur"}],idcard:[{type:"string",max:50,message:"证件号长度不能超过50",trigger:"blur"}],roleIds:[{required:!0,type:"array",min:1,message:"至少选择一个角色",trigger:"change"}]},tableColums:[{title:"登录名",key:"loginname"},{title:"姓名",key:"nickname"},{title:"手机号",key:"phone"},{title:"角色信息",key:"rolesDescStr",render:function(e,t){return e("span",{props:{},style:{"font-weight":"bold",color:"#ff9900"}},t.row.rolesDescStr)}},{title:"最后登录时间",key:"logged"},{title:"创建时间",key:"catTxt"},{title:"超级权限",key:"isAdmin",width:100,render:function(e,t){return"0"==t.row.isAdmin?e("Tag",{props:{type:"dot",color:"green"}},"是"):e("Tag",{props:{type:"dot",color:"red"}},"否")}},{title:"状态",key:"statusTxt",width:120,render:function(e,t){return"0"==t.row.status?e("Tag",{props:{type:"dot",color:"blue"}},t.row.statusTxt):"1"==t.row.status?e("Tag",{props:{type:"dot",color:"red"}},t.row.statusTxt):void 0}},{title:"操作",key:"action",width:200,align:"center",render:function(t,r){if(!r.row.dAt)return"0"==r.row.status?"0"==r.row.isAdmin?t("div",[u(e,t,r),a(e,t,r)]):t("div",[u(e,t,r),o(e,t,r),l(e,t,r),a(e,t,r)]):"0"==r.row.isAdmin?t("div",[u(e,t,r),a(e,t,r)]):t("div",[u(e,t,r),o(e,t,r),d(e,t,r),a(e,t,r)])}}]}}}},830:function(e,t,r){var n=r(831);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);r(61)("0f83059b",n,!1,{})},831:function(e,t,r){t=e.exports=r(60)(!1),t.push([e.i,"\n.margin-top-8 {\n  margin-top: 8px;\n}\n.margin-top-10 {\n  margin-top: 10px;\n}\n.margin-top-20 {\n  margin-top: 20px;\n}\n.margin-left-10 {\n  margin-left: 10px;\n}\n.margin-bottom-10 {\n  margin-bottom: 10px;\n}\n.margin-bottom-100 {\n  margin-bottom: 100px;\n}\n.margin-right-10 {\n  margin-right: 10px;\n}\n.padding-left-6 {\n  padding-left: 6px;\n}\n.padding-left-8 {\n  padding-left: 5px;\n}\n.padding-left-10 {\n  padding-left: 10px;\n}\n.padding-left-20 {\n  padding-left: 20px;\n}\n.height-100 {\n  height: 100%;\n}\n.height-120px {\n  height: 100px;\n}\n.height-200px {\n  height: 200px;\n}\n.height-492px {\n  height: 492px;\n}\n.height-460px {\n  height: 460px;\n}\n.line-gray {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5 {\n  padding-left: 10px;\n}\n[v-cloak] {\n  display: none;\n}\n",""])},832:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Row",[r("Col",{attrs:{span:"24"}},[r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"help-buoy"}}),e._v("\n                用户列表\n            ")],1),e._v(" "),r("Row",[r("Col",{attrs:{span:"8"}},[r("Button",{attrs:{type:"primary",icon:"person-add"},on:{click:e.add}},[e._v("新增用户")]),e._v(" "),r("Button",{attrs:{type:"primary",icon:"refresh"},on:{click:e.refresh}},[e._v("刷新")])],1),e._v(" "),r("Col",{attrs:{span:"8",offset:"8",align:"right"}},[r("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入..."},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),e._v(" "),r("span",{staticStyle:{margin:"0 10px"},on:{click:e.search}},[r("Button",{attrs:{type:"primary",icon:"search"}},[e._v("搜索")])],1)],1)],1),e._v(" "),r("Row",{staticClass:"margin-top-10"},[r("Table",{attrs:{context:e.self,border:"",data:e.userList,columns:e.tableColums,stripe:""}})],1),e._v(" "),r("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[r("div",{staticStyle:{float:"right"}},[r("Page",{attrs:{total:e.total,current:e.pageNumber,"page-size":e.pageSize,"show-total":"","show-elevator":""},on:{"on-change":e.search}})],1)])],1)],1)],1),e._v(" "),r("Modal",{attrs:{"mask-closable":!1},on:{"on-visible-change":e.vChange},model:{value:e.userModal,callback:function(t){e.userModal=t},expression:"userModal"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("Icon",{attrs:{type:"information-circled"}}),e._v(" "),r("span",[e._v(e._s(e.modalTitle))])],1),e._v(" "),r("Form",{ref:"formValidate",attrs:{"label-width":80,model:e.user,rules:e.ruleValidate}},[r("FormItem",{attrs:{label:"用户名",prop:"loginname"}},[r("Input",{staticStyle:{width:"300px"},attrs:{disabled:!e.isAdd,placeholder:"请输入..."},model:{value:e.user.loginname,callback:function(t){e.$set(e.user,"loginname",t)},expression:"user.loginname"}})],1),e._v(" "),r("FormItem",{attrs:{label:"姓名",prop:"nickname"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入..."},model:{value:e.user.nickname,callback:function(t){e.$set(e.user,"nickname",t)},expression:"user.nickname"}})],1),e._v(" "),r("FormItem",{attrs:{label:"手机号",prop:"phone"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入..."},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),e._v(" "),r("FormItem",{attrs:{label:"EMAIL",prop:"email"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入..."},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),e._v(" "),r("FormItem",{attrs:{label:"身份证号",prop:"idcard"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入..."},model:{value:e.user.idcard,callback:function(t){e.$set(e.user,"idcard",t)},expression:"user.idcard"}})],1),e._v(" "),r("FormItem",{attrs:{label:"管理员身份",prop:"isAdmin"}},[r("RadioGroup",{model:{value:e.user.isAdmin,callback:function(t){e.$set(e.user,"isAdmin",t)},expression:"user.isAdmin"}},[r("Radio",{attrs:{label:"0"}},[e._v("是")]),e._v(" "),r("Radio",{attrs:{label:"1"}},[e._v("否")])],1)],1),e._v(" "),r("FormItem",{attrs:{label:"角色",prop:"roleIds"}},[r("CheckboxGroup",{on:{"on-change":function(e){}},model:{value:e.user.roleIds,callback:function(t){e.$set(e.user,"roleIds",t)},expression:"user.roleIds"}},e._l(e.roleList,function(t){return r("Checkbox",{key:t.id,attrs:{label:t.id+""}},[r("span",[e._v(e._s(t.description))])])}))],1)],1),e._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"success",loading:e.modalLoading},on:{click:e.save}},[e._v("保存")]),e._v(" "),r("Button",{directives:[{name:"show",rawName:"v-show",value:e.isAdd,expression:"isAdd"}],on:{click:e.reset}},[e._v("重置")]),e._v(" "),r("Button",{attrs:{type:"error"},on:{click:function(t){e.userModal=!1}}},[e._v("关闭")])],1)],1)],1)},s=[];n._withStripped=!0;var i={render:n,staticRenderFns:s};t.default=i}});